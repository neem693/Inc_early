
------------------------------------------------------------------------------------------------------------------------
1.EMP 테이블에서 이름이 5글자인 사원중 급여가 가장 높은 사원의 이름,급여,부서명을 출력 
------------------------------------------------------------------------------------------------------------------------
SELECT ENAME,SAL,DNAME
FROM EMP E,DEPT D
WHERE E.DEPTNO=D.DEPTNO
AND SAL=(SELECT MAX(SAL) FROM EMP WHERE LENGTH(ENAME)=5)
AND LENGTH(ENAME)=5 

------------------------------------------------------------------------------------------------------------------------ 
2.CLARK이 속한 부서의 평균 연봉보다 높은 사원중 입사일이 가장 빠른 사원의 부서명, 사원명, 연봉을 출력하세요.
------------------------------------------------------------------------------------------------------------------------
SELECT DNAME,ENAME,SAL
FROM EMP E, DEPT D
WHERE E.DEPTNO=D.DEPTNO
AND HIREDATE=(
SELECT MIN(HIREDATE) FROM EMP
WHERE SAL > (
SELECT AVG(SAL) FROM EMP
WHERE DEPTNO=(SELECT DEPTNO FROM EMP WHERE ENAME='CLARK')
)
)

 
------------------------------------------------------------------------------------------------------------------------ 
3.ALLEN의 부서명을 출력하세요   
------------------------------------------------------------------------------------------------------------------------
SELECT DNAME FROM DEPT
WHERE DEPTNO=(
SELECT DEPTNO FROM EMP
WHERE ENAME='ALLEN'
) 
 
------------------------------------------------------------------------------------------------------------------------
4.이름에 J가 들어가는 사원중, 제일 많은 급여를 받는 사람보다 많은 급여를 받는 사원의 사원번호, 이름, 부서,급여를 출력하되, 결과를 급여가 높은 순으로 정렬하라.   
 ------------------------------------------------------------------------------------------------------------------------
SELECT EMPNO,ENAME,DNAME,SAL
FROM EMP E, DEPT D
WHERE SAL > (
SELECT MAX(SAL) FROM EMP
WHERE ENAME LIKE '%J%'
) AND E.DEPTNO=D.DEPTNO
ORDER BY SAL DESC

 
 
------------------------------------------------------------------------------------------------------------------------
5.두번째로 많은 급여를 받는 사원의 이름과 급여를 출력하시오   
------------------------------------------------------------------------------------------------------------------------
SELECT ENAME,SAL FROM EMP
WHERE SAL=(
SELECT MAX(SAL) FROM 
(
SELECT ENAME,SAL FROM EMP
WHERE SAL < (
 SELECT MAX(SAL) FROM EMP
) ORDER BY SAL DESC
)
)
 


------------------------------------------------------------------------------------------------------------------------
6.입사일이 2번째로 빠른사람의 부서명과 이름, 입사일을 출력하세요   
------------------------------------------------------------------------------------------------------------------------ 
SELECT DNAME,ENAME,HIREDATE
FROM EMP E,DEPT D
WHERE E.DEPTNO=D.DEPTNO
AND HIREDATE=(
SELECT MIN(HIREDATE) FROM
(
   SELECT HIREDATE FROM EMP  WHERE HIREDATE > (
                     SELECT MIN(HIREDATE) FROM EMP
   )
)
) 
 
------------------------------------------------------------------------------------------------------------------------
7.DALLAS에 위치한 부서에 최대 급여를 받는 사원에서 최소 급여를 받는사람을 뺀 급여를 출력   
------------------------------------------------------------------------------------------------------------------------ 
SELECT 
(SELECT MAX(SAL) FROM EMP
WHERE DEPTNO=(
SELECT DEPTNO FROM DEPT
WHERE LOC='DALLAS'
)) - (SELECT MIN(SAL) FROM EMP) FROM DUAL 


------------------------------------------------------------------------------------------------------------------------
8.이름에 s가 들어가는 모든 사원의 수와 최소, 평균, 최대연봉을 구하시오   
 ------------------------------------------------------------------------------------------------------------------------
SELECT COUNT(ENAME),MIN(SAL),AVG(SAL),MAX(SAL) FROM EMP WHERE ENAME LIKE '%S%'


 
------------------------------------------------------------------------------------------------------------------------ 
9.smith와 같은 부서에 근무하는 사람 중 연봉이 제일 적은 사람을 출력하시요   
------------------------------------------------------------------------------------------------------------------------
SELECT MIN(SAL) FROM EMP
WHERE DEPTNO=(
 SELECT DEPTNO FROM EMP WHERE ENAME='SMITH' 
)
 

------------------------------------------------------------------------------------------------------------------------
10.최대 급여를 받는 사원의 지역에 속한 사원중 이름에 A가 들어간 사원의 이름명과 부서명을 출력하시요   
------------------------------------------------------------------------------------------------------------------------ 
SELECT ENAME ,DNAME
FROM EMP E, DEPT D
WHERE E.DEPTNO=(
SELECT DEPTNO FROM EMP
WHERE SAL=(
SELECT MAX(SAL) FROM EMP
)
) AND ENAME LIKE '%A%' 
AND E.DEPTNO=D.DEPTNO
 
 
------------------------------------------------------------------------------------------------------------------------
11.10번 부서 중에서 30번 부서에는 없는 업무를 하는 사원의 사원번호, 이름, 부서명, 입사일, 지역을 출력하라.
------------------------------------------------------------------------------------------------------------------------
SELECT EMPNO,ENAME,DNAME,HIREDATE,LOC
FROM EMP E, DEPT D
WHERE E.DEPTNO=D.DEPTNO 
AND JOB=(
SELECT JOB FROM EMP WHERE DEPTNO=10
AND JOB NOT IN (SELECT JOB FROM EMP WHERE DEPTNO=30 )
)

 
------------------------------------------------------------------------------------------------------------------------
12.시카고에서 근무하는 사원의 이름과 근무지역을 출력하시오   
------------------------------------------------------------------------------------------------------------------------
SELECT ENAME,LOC 
FROM EMP E, DEPT D
WHERE E.DEPTNO=D.DEPTNO
AND E.DEPTNO = (
SELECT DEPTNO FROM DEPT WHERE LOC='CHICAGO'
) 


------------------------------------------------------------------------------------------------------------------------ 
13.위치가 NEW YORK인 사원들 중 입사일이 가장 늦은사람의 부서명과 사원이름을 출력해라   
------------------------------------------------------------------------------------------------------------------------
SELECT DNAME,ENAME FROM 
EMP E,DEPT D
WHERE HIREDATE=(SELECT MAX(HIREDATE) FROM EMP WHERE DEPTNO=(SELECT DEPTNO FROM DEPT WHERE LOC='NEW YORK'))
AND E.DEPTNO=D.DEPTNO

 
------------------------------------------------------------------------------------------------------------------------
14.입사일로부터 90일이 지난 후의 사원이름 입사일 ,90일 후의 날,급여를 출력하여라   
------------------------------------------------------------------------------------------------------------------------
SELECT ENAME,HIREDATE, HIREDATE+90,SAL FROM EMP

 

------------------------------------------------------------------------------------------------------------------------
15.10번 부서의 모든 사람들이게 급여의 10%를 보너스로 지불하기로 하였다. 10번 부서 사람들의 이름, 급여, 보너스 금액 출력하되 급여가 높은순부터 출력하라.   
------------------------------------------------------------------------------------------------------------------------
 SELECT ENAME,SAL,(SAL*0.1)+SAL AS BONUS  FROM EMP ORDER BY BONUS DESC
 

------------------------------------------------------------------------------------------------------------------------
16.82년도에 입사한 사원의 사원번호,성명, 업무, 급여, 입사일자, 부서번호를 출력하세요   
------------------------------------------------------------------------------------------------------------------------
SELECT EMPNO,ENAME,JOB,SAL,HIREDATE,DEPTNO FROM EMP WHERE SUBSTR(HIREDATE,0,2)='82' 


------------------------------------------------------------------------------------------------------------------------
17.'SCOTT'와 같은 부서에서 일하면서 위치가 BOSTON 인 사람의 이름과 부서명을 출력해라   
------------------------------------------------------------------------------------------------------------------------
SELECT ENAME,HIREDATE 
FROM EMP E, DEPT D
WHERE E.DEPTNO=D.DEPTNO
AND E.DEPTNO=(
SELECT DEPTNO 
FROM EMP 
WHERE ENAME='SCOTT'
) 


------------------------------------------------------------------------------------------------------------------------ 
18.위치가 DALLAS인 부서에 속한 사원들의 이름과 부서명을 출력하세요.
------------------------------------------------------------------------------------------------------------------------
SELECT ENAME,DNAME
FROM EMP E,DEPT D
WHERE E.DEPTNO=(
SELECT DEPTNO FROM DEPT WHERE LOC='DALLAS'
) AND E.DEPTNO=D.DEPTNO 
 

------------------------------------------------------------------------------------------------------------------------
19.SCOTT이 소속된 부서의 사원중 급여가 1000에서 2000사이인 사원의 이름과 부서명을 출력하세요   
------------------------------------------------------------------------------------------------------------------------
SELECT ENAME,DNAME,SAL
FROM EMP E,DEPT D
WHERE E.DEPTNO=(SELECT DEPTNO FROM EMP WHERE ENAME='SCOTT')
AND E.DEPTNO=D.DEPTNO
AND SAL BETWEEN 1000 AND 2000


------------------------------------------------------------------------------------------------------------------------
20.EMP Table에서 이름, 급여, 커미션 금액, 총액(sal + comm)을 구하여 총액이 많은 순서로 출력하라. 단, 커미션이 NULL인 사람은 제외한다.   
------------------------------------------------------------------------------------------------------------------------
SELECT ENAME,SAL,COMM,(SAL+COMM) AS TOTAL FROM EMP 
WHERE COMM IS NOT NULL
ORDER BY TOTAL DESC 
